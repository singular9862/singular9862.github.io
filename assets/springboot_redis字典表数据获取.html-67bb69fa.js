import{_ as n}from"./plugin-vue_export-helper-c27b6911.js";import{o as s,c as a,d as t}from"./app-ca1a10f0.js";const p="data:image/png;base64,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",e="/assets/1ad2e4ad-cac5-6e75-c7f4-c135f0b50202-f1c26529.png",o={},c=t(`<hr><h2 id="springboot-redis字典表数据获取-前端使用layui框架" tabindex="-1"><a class="header-anchor" href="#springboot-redis字典表数据获取-前端使用layui框架" aria-hidden="true">#</a> springboot+redis字典表数据获取，前端使用layui框架</h2><h4 id="前言" tabindex="-1"><a class="header-anchor" href="#前言" aria-hidden="true">#</a> 前言</h4><p>最终目的是使用redis存取字典表。这个案例就将使用到springboot+redis，但在此过程中遇见很多问题，逐个击破，最后实现功能。</p><h4 id="准备工作" tabindex="-1"><a class="header-anchor" href="#准备工作" aria-hidden="true">#</a> 准备工作</h4><p>这里只是实现springboo集成redis，加上前端集成layui，如果单纯只是想使用springboot+layui的办法，在另一篇文章已经给出。</p><p>这里我的目的是从mysql数据库获取值，如果不想这么麻烦，也可以将所有事情直接交给前端，使用layui和layui的插件。在另一篇文章中也有相关说明。</p><p>首先需要以下依赖：</p><p>注：只展示redis所需要的</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>	 <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">-</span>data<span class="token operator">-</span>redis<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>commons<span class="token operator">-</span>pool2<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>redis<span class="token punctuation">.</span>clients<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>jedis<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>utils</p><p>这里使用Jedis来对redis数据库进行操作，但是个人目前还没找到直接用注解或是系统配置文件自动配置的方法，因此这里还是需要使用JedisUtils工具类，注入配置文件，启动redis。</p><p>我这里的目的只是想使用redis存取值，不需要那么复杂的操作，因此工具类也只是一个简单的连接工具而已，并没有什么复杂的方法。</p><p>JedisPoolUtils：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JedisPoolUtils</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">JedisPool</span> jedisPool<span class="token punctuation">;</span>

    <span class="token comment">//类加载之前会执行的代码块</span>
    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token comment">//1.读取配置文件</span>
        <span class="token class-name">InputStream</span> is  <span class="token operator">=</span><span class="token class-name">JedisPoolUtils</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;redis.properties&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2.创建Properties</span>
        <span class="token class-name">Properties</span> pro <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//3.</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            pro<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      
        <span class="token class-name">JedisPoolConfig</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JedisPoolConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 config<span class="token punctuation">.</span><span class="token function">setMaxTotal</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>pro<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;maxTotal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 config<span class="token punctuation">.</span><span class="token function">setMaxIdle</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>pro<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;maxIdle&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jedisPool<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">JedisPool</span><span class="token punctuation">(</span>config<span class="token punctuation">,</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>pro<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;port&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Jedis</span> <span class="token function">getJedis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Jedis</span> jedis <span class="token operator">=</span> jedisPool<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> jedis<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">JedisPoolUtils</span><span class="token punctuation">.</span><span class="token function">getJedis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>jedis.properties：</p><p>需要什么配什么，不用配那么多</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>host<span class="token operator">=</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>
port<span class="token operator">=</span><span class="token number">6379</span>
maxTotal<span class="token operator">=</span><span class="token number">50</span>
maxIdle<span class="token operator">=</span><span class="token number">10</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="后端代码" tabindex="-1"><a class="header-anchor" href="#后端代码" aria-hidden="true">#</a> 后端代码</h4><p>如果是使用redis存下来的值，就不会到数据访问层，况且springboot也没有使用到dao层，之前使用的是mapper接口的方法，这里也不会访问到那里去。</p><p>redis存取值可以止步于service层或者是controller层，controller层不方便写一些底层代码，因此放在service实现类里。</p><p>service接口</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">SelectMapper</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Province1</span><span class="token punctuation">&gt;</span></span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">City1</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryById</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>service接口</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">SelectService</span> <span class="token punctuation">{</span>
   <span class="token class-name">String</span> <span class="token function">getProvinceJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">String</span> <span class="token function">getCityJson</span><span class="token punctuation">(</span><span class="token class-name">String</span> pId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>service实现类</p><p>这里可以整合为一个方法放在utils类中直接调用，按道理来说底层代码也确实应该这么做，但这里不必吹毛求疵了，个人技术也还没到自己编写底层工具类的程度。</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SelectServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">SelectService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Resource</span>
    <span class="token class-name">SelectMapper</span> selectMapper<span class="token punctuation">;</span>
<span class="token class-name">Jedis</span> jedis <span class="token operator">=</span> <span class="token class-name">JedisPoolUtils</span><span class="token punctuation">.</span><span class="token function">getJedis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">ObjectMapper</span> objectMapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getProvinceJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> province_json <span class="token operator">=</span> jedis<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;province&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>province_json <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> province_json<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Province1</span><span class="token punctuation">&gt;</span></span> query <span class="token operator">=</span> selectMapper<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                province_json <span class="token operator">=</span> objectMapper<span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JsonProcessingException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            jedis<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;province&quot;</span><span class="token punctuation">,</span>province_json<span class="token punctuation">)</span><span class="token punctuation">;</span>
            jedis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;有数据，直接使用redis缓存&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> province_json <span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getCityJson</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> city_json <span class="token operator">=</span> jedis<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;city&quot;</span><span class="token operator">+</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>city_json <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> city_json<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">City1</span><span class="token punctuation">&gt;</span></span> query <span class="token operator">=</span> selectMapper<span class="token punctuation">.</span><span class="token function">queryById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                city_json <span class="token operator">=</span> objectMapper<span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JsonProcessingException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            jedis<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;city&quot;</span><span class="token punctuation">,</span>city_json<span class="token punctuation">)</span><span class="token punctuation">;</span>
            jedis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;有数据，直接使用redis缓存&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> city_json <span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注：记住要关闭jedis，否则无法拿值。</p><p>controller控制层类</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Controller</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/query&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SelectController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Resource</span>
    <span class="token class-name">SelectService</span> selectService<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/getP&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> query <span class="token operator">=</span> selectService<span class="token punctuation">.</span><span class="token function">getProvinceJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> query<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/getC&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getC</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span> <span class="token class-name">String</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> queryCity <span class="token operator">=</span> selectService<span class="token punctuation">.</span><span class="token function">getCityJson</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> queryCity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注：</p><p>写完之后一定要写测试类测试是否能取到值，否则后面找错更麻烦。这也是我遇到的问题之一，花费了很长时间找问题。这里需要注意springboot使用test测试类需要添加两个注解，在另一篇文章也有写到，不想找的话直接看下面也可</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Resource</span>
    <span class="token class-name">SelectService</span> selectService<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@org.junit.Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">City1</span><span class="token punctuation">&gt;</span></span> query <span class="token operator">=</span> selectService<span class="token punctuation">.</span><span class="token function">queryById</span><span class="token punctuation">(</span><span class="token string">&quot;1001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        query<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>city1 <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>city1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="前端部分" tabindex="-1"><a class="header-anchor" href="#前端部分" aria-hidden="true">#</a> 前端部分</h4><p>这里前端直接使用layui框架，相关代码是直接重复造了我另一篇文章的轮子。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span><span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">&quot;en&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">&quot;UTF-8&quot;</span><span class="token operator">&gt;</span>    <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Title<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>    <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;js/layui/layui.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>    <span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">&quot;stylesheet&quot;</span> href<span class="token operator">=</span><span class="token string">&quot;js/layui/css/layui.css&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span><span class="token operator">&lt;</span>body<span class="token operator">&gt;</span><span class="token operator">&lt;</span>form <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;layui-form&quot;</span><span class="token operator">&gt;</span>    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;layui-input-inline&quot;</span><span class="token operator">&gt;</span>    <span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">&quot;province&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;province&quot;</span> lay<span class="token operator">-</span>verify<span class="token operator">=</span><span class="token string">&quot;required&quot;</span>  <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;select&quot;</span> lay<span class="token operator">-</span>filter<span class="token operator">=</span><span class="token string">&quot;brickType&quot;</span><span class="token operator">&gt;</span>        <span class="token operator">&lt;</span>option  id<span class="token operator">=</span><span class="token string">&quot;pid&quot;</span> value<span class="token operator">=</span><span class="token string">&quot;&quot;</span>  <span class="token operator">&gt;</span>请选择省<span class="token operator">&lt;</span><span class="token operator">/</span>option<span class="token operator">&gt;</span>    <span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;layui-input-inline&quot;</span><span class="token operator">&gt;</span>        <span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">&quot;city&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;city&quot;</span> lay<span class="token operator">-</span>verify<span class="token operator">=</span><span class="token string">&quot;required&quot;</span>  <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;select&quot;</span><span class="token operator">&gt;</span>            <span class="token operator">&lt;</span>option id<span class="token operator">=</span><span class="token string">&quot;cid&quot;</span> value<span class="token operator">=</span><span class="token string">&quot;&quot;</span> <span class="token operator">&gt;</span>请选择市<span class="token operator">&lt;</span><span class="token operator">/</span>option<span class="token operator">&gt;</span>        <span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>    layui<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&#39;form&#39;</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">var</span> $ <span class="token operator">=</span> layui<span class="token punctuation">.</span>jquery<span class="token punctuation">;</span>        <span class="token keyword">var</span> form <span class="token operator">=</span> layui<span class="token punctuation">.</span>form<span class="token punctuation">;</span>        $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>            <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;/query/getP&#39;</span><span class="token punctuation">,</span>            <span class="token literal-property property">dataType</span><span class="token operator">:</span> <span class="token string">&#39;json&#39;</span><span class="token punctuation">,</span>            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;post&#39;</span><span class="token punctuation">,</span>            <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">query</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token comment">//$(&quot;#province&quot;).append(new Option(&quot;请选择省&quot;, &quot;0&quot;));                    $.each(query, function(index, item) {                        $(&#39;#province&#39;).append(new Option(pvalue =item.name,pid =item.id));                    });                form.render(&quot;select&quot;);            }        });        form.on(&#39;select(brickType)&#39;, function(data){            var val=data.value;            //console.info(val);            $.ajax({                url: &#39;/query/getC&#39;,                data:{id:val},                dataType: &#39;json&#39;,                type: &#39;post&#39;,                success: function(queryCity) {                    //$(&quot;#province&quot;).append(new Option(&quot;请选择省&quot;, &quot;0&quot;));                    $(&#39;#city&#39;).empty();                    $.each(queryCity, function(index, item) {                        $(&#39;#city&#39;).append(new Option(cvalue =item.name,cid =item.id));                    });                    form.render(&quot;select&quot;);                }            });        });    });</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h6 id="注" tabindex="-1"><a class="header-anchor" href="#注" aria-hidden="true">#</a> 注</h6><ul><li>1.前端编写注意边写边测试。否则后面很难找bug。</li></ul><h4 id="最终效果" tabindex="-1"><a class="header-anchor" href="#最终效果" aria-hidden="true">#</a> 最终效果</h4><p>数据是自己写在mysql里面的，所以值不是很多<br> 再返回Java后台，在service的实现类中已经写明，如果能从redis中获取数据，就会在后台打印一串文字，通过刷新页面。</p><p>后台输出如下值：<br> 说明使用的是redis中的值，并没有返回到mysql。</p><figure><img src="`+p+'" alt="img.png" tabindex="0" loading="lazy"><figcaption>img.png</figcaption></figure><p>在redis客户端中也可以查到值（忽略编码格式）：<br><img src="'+e+'" alt="img.png" loading="lazy"></p><h4 id="写在后面" tabindex="-1"><a class="header-anchor" href="#写在后面" aria-hidden="true">#</a> 写在后面</h4><p>以上代码还存在一些缺陷，比如字典表值改变了，就不能及时获取到更新后的mysql数据。</p><p>最笨的方法就是定时更新，其次可以在mysql数据update之后要么更新redis，要么在update中嵌入语句，直接删除之前的redis。</p><p>个人觉得直接删除的方法比较适用。</p><p>最后，在整个过程中需要保持redis服务器开启。</p>',49),l=[c];function i(u,r){return s(),a("div",null,l)}const v=n(o,[["render",i],["__file","springboot_redis字典表数据获取.html.vue"]]);export{v as default};
